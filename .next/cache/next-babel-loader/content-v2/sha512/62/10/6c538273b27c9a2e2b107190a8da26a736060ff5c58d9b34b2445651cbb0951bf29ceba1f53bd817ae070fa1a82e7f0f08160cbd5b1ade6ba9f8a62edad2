{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/luan/Documentos/igniteDesafio 5/src/pages/index.tsx\";\nimport { Box } from '@chakra-ui/react';\nimport { useMemo } from 'react';\nimport { useInfiniteQuery } from 'react-query';\nimport { Header } from '../components/Header';\nimport { CardList } from '../components/CardList';\nimport axios from 'axios';\nexport default function Home() {\n  async function fetchProjects({\n    pageParam = null\n  }) {\n    if (pageParam) {\n      const data = await axios.get('/api/images', {\n        params: {\n          after: pageParam\n        }\n      });\n      return data;\n    }\n\n    const data = await axios.get('/api/images');\n    return data;\n  }\n\n  const {\n    data,\n    isLoading,\n    isError,\n    isFetchingNextPage,\n    fetchNextPage,\n    hasNextPage\n  } = useInfiniteQuery('images', fetchProjects, {\n    getNextPageParam: result => result.after ? result.after : null\n  } // TODO AXIOS REQUEST WITH PARAM\n  // TODO GET AND RETURN NEXT PAGE PARAM\n  );\n  const formattedData = useMemo(() => {\n    let formattedDataTotal = [];\n    const dataPages = data === null || data === void 0 ? void 0 : data.pages; // TODO FORMAT AND FLAT DATA ARRAY\n\n    dataPages === null || dataPages === void 0 ? void 0 : dataPages.map(page => {\n      formattedDataTotal = [...formattedDataTotal, ...page.data]; // eslint-disable-next-line no-useless-return\n\n      return;\n    });\n    return formattedDataTotal;\n  }, [data]); // TODO RENDER LOADING SCREEN\n  // TODO RENDER ERROR SCREEN\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      maxW: 1120,\n      px: 20,\n      mx: \"auto\",\n      my: 20,\n      children: /*#__PURE__*/_jsxDEV(CardList, {\n        cards: formattedData\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}","map":{"version":3,"sources":["/home/luan/Documentos/igniteDesafio 5/src/pages/index.tsx"],"names":["Box","useMemo","useInfiniteQuery","Header","CardList","axios","Home","fetchProjects","pageParam","data","get","params","after","isLoading","isError","isFetchingNextPage","fetchNextPage","hasNextPage","getNextPageParam","result","formattedData","formattedDataTotal","dataPages","pages","map","page"],"mappings":";;;AAAA,SAAiBA,GAAjB,QAA4B,kBAA5B;AACA,SAASC,OAAT,QAAwB,OAAxB;AACA,SAASC,gBAAT,QAAiC,aAAjC;AAEA,SAASC,MAAT,QAAuB,sBAAvB;AACA,SAASC,QAAT,QAAyB,wBAAzB;AAIA,OAAOC,KAAP,MAAkB,OAAlB;AAkBA,eAAe,SAASC,IAAT,GAA6B;AAE1C,iBAAeC,aAAf,CAA8B;AAAEC,IAAAA,SAAS,GAAG;AAAd,GAA9B,EAAoD;AAClD,QAAIA,SAAJ,EAAe;AACd,YAAMC,IAAiB,GAAG,MAAMJ,KAAK,CAACK,GAAN,CAAU,aAAV,EAAyB;AACvDC,QAAAA,MAAM,EAAE;AACRC,UAAAA,KAAK,EAACJ;AADE;AAD+C,OAAzB,CAAhC;AAMC,aAAOC,IAAP;AACD;;AACD,UAAMA,IAAiB,GAAG,MAAMJ,KAAK,CAACK,GAAN,CAAU,aAAV,CAAhC;AAEA,WAAOD,IAAP;AACD;;AAED,QAAM;AACJA,IAAAA,IADI;AAEJI,IAAAA,SAFI;AAGJC,IAAAA,OAHI;AAIJC,IAAAA,kBAJI;AAKJC,IAAAA,aALI;AAMJC,IAAAA;AANI,MAOFf,gBAAgB,CAClB,QADkB,EACRK,aADQ,EACO;AAACW,IAAAA,gBAAgB,EAAGC,MAAD,IAAWA,MAAM,CAACP,KAAP,GAAaO,MAAM,CAACP,KAApB,GAA0B;AAAxD,GADP,CAElB;AAEA;AAJkB,GAPpB;AAcA,QAAMQ,aAAa,GAAGnB,OAAO,CAAC,MAAM;AAClC,QAAIoB,kBAAkB,GAAG,EAAzB;AACC,UAAMC,SAAS,GAAIb,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAEc,KAAzB,CAFiC,CAGlC;;AAEAD,IAAAA,SAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAEE,GAAX,CAAeC,IAAI,IAAI;AACrBJ,MAAAA,kBAAkB,GAAG,CAAC,GAAGA,kBAAJ,EAAuB,GAAGI,IAAI,CAAChB,IAA/B,CAArB,CADqB,CAErB;;AACA;AACD,KAJD;AAMA,WAAOY,kBAAP;AACD,GAZ4B,EAY1B,CAACZ,IAAD,CAZ0B,CAA7B,CA/B0C,CA6C1C;AAEA;;AAEA,sBACE;AAAA,4BACE,QAAC,MAAD;AAAA;AAAA;AAAA;AAAA,YADF,eAGE,QAAC,GAAD;AAAK,MAAA,IAAI,EAAE,IAAX;AAAiB,MAAA,EAAE,EAAE,EAArB;AAAyB,MAAA,EAAE,EAAC,MAA5B;AAAmC,MAAA,EAAE,EAAE,EAAvC;AAAA,6BACE,QAAC,QAAD;AAAU,QAAA,KAAK,EAAEW;AAAjB;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAHF;AAAA,kBADF;AAUD","sourcesContent":["import { Button, Box } from '@chakra-ui/react';\nimport { useMemo } from 'react';\nimport { useInfiniteQuery } from 'react-query';\n\nimport { Header } from '../components/Header';\nimport { CardList } from '../components/CardList';\nimport { api } from '../services/api';\nimport { Loading } from '../components/Loading';\nimport { Error } from '../components/Error';\nimport axios from 'axios';\n\n\ninterface Card {\ntitle:string;\ndescription:string;\nurl:string;\nts:number;\nid:string\n}\n\n\ninterface ResponseData {\ndata:Card[];\nafter:string|null;\n}\n\n\nexport default function Home(): JSX.Element {\n\n  async function fetchProjects ({ pageParam = null})  {\n    if (pageParam) {\n     const data:ResponseData = await axios.get('/api/images', {\n       params: {\n       after:pageParam\n       },\n      })\n\n      return data\n    }\n    const data:ResponseData = await axios.get('/api/images')\n\n    return data\n  }\n\n  const {\n    data,\n    isLoading,\n    isError,\n    isFetchingNextPage,\n    fetchNextPage,\n    hasNextPage,\n  } = useInfiniteQuery(\n    'images', fetchProjects, {getNextPageParam: (result)=> result.after?result.after:null}\n    // TODO AXIOS REQUEST WITH PARAM\n    ,\n    // TODO GET AND RETURN NEXT PAGE PARAM\n  );\n  \n  const formattedData = useMemo(() => {\n    let formattedDataTotal = [] as Card[];\n     const dataPages =  data?.pages\n    // TODO FORMAT AND FLAT DATA ARRAY\n\n    dataPages?.map(page => {\n      formattedDataTotal = [...formattedDataTotal,...page.data];\n      // eslint-disable-next-line no-useless-return\n      return;\n    });\n\n    return formattedDataTotal;\n  }, [data]);\n\n  // TODO RENDER LOADING SCREEN\n\n  // TODO RENDER ERROR SCREEN\n  \n  return (\n    <>\n      <Header />\n\n      <Box maxW={1120} px={20} mx=\"auto\" my={20}>\n        <CardList cards={formattedData} />\n        {/* TODO RENDER LOAD MORE BUTTON IF DATA HAS NEXT PAGE */}\n      </Box>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}